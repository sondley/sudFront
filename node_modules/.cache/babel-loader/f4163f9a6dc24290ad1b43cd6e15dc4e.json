{"ast":null,"code":"import _objectSpread from \"/Users/sondley/Desktop/PapaRohenson/grandsud/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport api from \"../../api\";\nimport Cookie from \"react-cookies\";\nimport decode from \"jwt-decode\";\nimport { navigate, endNavigation } from \"./navigate\";\nexport var LOGOUT = \"LOGOUT\";\nexport var LOGIN = \"LOGIN\";\nexport var LOGIN_SUCCESS = \"LOGIN_SUCCESS\";\nexport var LOGIN_FAIL = \"LOGIN_FAIL\";\nexport var LOGGED_USER = \"LOGGED_USER\";\nexport var LOGGED_USER_SUCCESS = \"LOGGED_USER_SUCCESS\";\nexport var LOGGED_USER_FAIL = \"LOGGED_USER_FAIL\";\nexport var REFRESH_TOKEN = \"REFRESH_TOKEN\";\nexport var REFRESH_TOKEN_SUCCESS = \"REFRESH_TOKEN_SUCCESS\";\nexport var REFRESH_TOKEN_FAIL = \"REFRESH_TOKEN_FAIL\";\nexport var GET_USERS = \"GET_USERS\";\nexport var GET_USERS_SUCCESS = \"GET_USERS_SUCCESS\";\nexport var GET_USERS_FAIL = \"GET_USERS_FAIL\";\nexport var CREATE_USER = \"CREATE_USER\";\nexport var CREATE_USER_SUCCESS = \"CREATE_USER_SUCCESS\";\nexport var CREATE_USER_FAIL = \"CREATE_USER_FAIL\";\nexport var MODIFY_USER = \"MODIFY_USER\";\nexport var MODIFY_USER_SUCCESS = \"MODIFY_USER_SUCCESS\";\nexport var MODIFY_USER_FAIL = \"MODIFY_USER_FAIL\";\nexport var DELETE_USER = \"DELETE_USER\";\nexport var DELETE_USER_SUCCESS = \"DELETE_USER_SUCCESS\";\nexport var DELETE_USER_FAIL = \"DELETE_USER_FAIL\";\n\nfunction requestBegin(type) {\n  return {\n    type: type\n  };\n}\n\nfunction requestSuccess(type, user, message, token) {\n  return {\n    type: type,\n    payload: {\n      user: user,\n      message: message,\n      token: token\n    }\n  };\n}\n\nfunction requestFail(type, message) {\n  return {\n    type: type,\n    payload: {\n      message: message\n    }\n  };\n}\n\nexport function logout() {\n  return function (dispatch) {\n    Cookie.remove(\"sessionCookie\");\n    return dispatch(requestBegin(LOGOUT));\n  };\n}\nexport function login(username, password, rememberMe) {\n  return function (dispatch) {\n    dispatch(requestBegin(LOGIN));\n    return api.requestPOST(\"/authenticate\", {\n      email: username,\n      motDePasse: password\n    }).then(function (objResponse) {\n      if (objResponse.data.success) {\n        var _objResponse$data$dat = objResponse.data.data,\n            user = _objResponse$data$dat.user,\n            token = _objResponse$data$dat.token;\n        var data = {\n          user: user,\n          token: token\n        };\n        Cookie.save(\"sessionCookie\", data, {\n          path: \"/\",\n          maxAge: 3600\n        });\n\n        if (rememberMe === true) {\n          var preferences = {\n            email: username,\n            rememberMe: rememberMe\n          };\n          Cookie.save(\"userPreferences\", preferences, {\n            path: \"/\"\n          });\n        } else {\n          Cookie.remove(\"userPreferences\");\n        }\n\n        dispatch(requestSuccess(LOGIN_SUCCESS, user, objResponse.data.message, token));\n        var page = \"\";\n\n        switch (user.role) {\n          case \"caissier\":\n            page = \"/validate_solicitude\";\n            break;\n\n          case \"directeur\":\n            page = \"/director_reports\";\n            break;\n\n          case \"vendeur\":\n            page = \"/orders\";\n            break;\n\n          case \"contable\":\n            page = \"/cash_status\";\n            break;\n\n          case \"assistance\":\n            page = \"/warehouse\";\n            break;\n\n          case \"comite\":\n            page = \"/benefits_reports\";\n            break;\n        }\n\n        api.api.defaults.headers.common[\"Authorization\"] = \"bearer \" + token;\n        dispatch(navigate(page));\n        dispatch(endNavigation());\n      } else {\n        dispatch(requestFail(LOGIN_FAIL, objResponse.data.message));\n      }\n    }).catch(function (objError) {\n      dispatch(requestFail(LOGIN_FAIL, objError));\n    });\n  };\n}\nexport function checkSession() {\n  return function (dispatch) {\n    dispatch(requestBegin(LOGGED_USER));\n    var data = Cookie.load(\"sessionCookie\");\n\n    if (data !== undefined) {\n      var user = data.user,\n          token = data.token;\n      var decodedToken = decode(token);\n      var tokenExpiration = decodedToken.exp;\n      var currentTime = Math.floor(new Date().getTime() / 1000.0);\n      var remainingTime = tokenExpiration - currentTime;\n      Cookie.save(\"sessionCookie\", data, {\n        path: \"/\",\n        maxAge: remainingTime\n      });\n      dispatch(requestSuccess(LOGGED_USER_SUCCESS, user, \"Session Open\", token));\n      api.api.defaults.headers.common[\"Authorization\"] = \"bearer \" + token;\n    } else {\n      dispatch(requestFail(LOGGED_USER_FAIL, \"No Session\"));\n    }\n  };\n}\nexport function resetToken() {\n  return function (dispatch) {\n    dispatch(requestBegin(REFRESH_TOKEN));\n    return api.requestGET(\"/resetToken\").then(function (objResponse) {\n      if (objResponse.data.success) {\n        var data = Cookie.load(\"sessionCookie\");\n        data = _objectSpread({}, data, {\n          token: objResponse.data.data.token\n        });\n        Cookie.save(\"sessionCookie\", data, {\n          path: \"/\",\n          maxAge: 3600\n        });\n        dispatch(requestSuccess(REFRESH_TOKEN_SUCCESS, null, objResponse.data.message, objResponse.data.data.token));\n        api.api.defaults.headers.common[\"Authorization\"] = \"bearer \" + objResponse.data.data.token;\n      } else {\n        dispatch(requestFail(REFRESH_TOKEN_FAIL, objResponse.data.message));\n      }\n    }).catch(function (objError) {\n      dispatch(requestFail(REFRESH_TOKEN_FAIL, objError.response.data.message));\n    });\n  };\n} // export function getUsers() {\n//   return dispatch => {\n//     dispatch(getUsersBegin());\n//     return api\n//       .requestGET(\"/usuarios\")\n//       .then(objResponse => {\n//         dispatch(getUsersSuccess(objResponse.data.results));\n//       })\n//       .catch(objError => {\n//         dispatch(getUsersFail(objError));\n//       });\n//   };\n// }\n// export function createUser(user, onClose) {\n//   return dispatch => {\n//     dispatch(createUserBegin());\n//     return api\n//       .requestPOST(\"/usuarios\", {\n//         nombres: user.nombres,\n//         appelidos: user.appelidos,\n//         cedula: user.cedula,\n//         telefono: user.telefono,\n//         direccion: user.direccion,\n//         usuario: user.usuario,\n//         correo: user.correo,\n//         password: user.password\n//       })\n//       .then(objResponse => {\n//         dispatch(createUserSuccess(objResponse.data));\n//         onClose();\n//       })\n//       .catch(objError => {\n//         dispatch(createUserFail(objError));\n//       });\n//   };\n// }\n// export function modifyUser(user, onClose) {\n//   return dispatch => {\n//     dispatch(modifyUserBegin());\n//     return api\n//       .requestPUT(`/usuarios/${user.id}`, {\n//         nombres: user.nombres,\n//         appelidos: user.appelidos,\n//         cedula: user.cedula,\n//         telefono: user.telefono,\n//         direccion: user.direccion,\n//         usuario: user.usuario,\n//         correo: user.correo,\n//         password: user.password\n//       })\n//       .then(objResponse => {\n//         console.log(objResponse);\n//         dispatch(modifyUserSuccess(user));\n//         onClose();\n//       })\n//       .catch(objError => {\n//         dispatch(modifyUserFail(objError));\n//       });\n//   };\n// }\n// export function deleteUser(id, onClose) {\n//   return dispatch => {\n//     dispatch(deleteUserBegin());\n//     return api\n//       .requestDELETE(`/usuarios/${id.id}`)\n//       .then(objResponse => {\n//         console.log(objResponse);\n//         dispatch(deleteUserSuccess(id.id));\n//         onClose();\n//       })\n//       .catch(objError => {\n//         dispatch(deleteUserFail(objError));\n//       });\n//   };\n// }","map":{"version":3,"sources":["/Users/sondley/Desktop/PapaRohenson/grandsud/src/redux/actions/user.js"],"names":["api","Cookie","decode","navigate","endNavigation","LOGOUT","LOGIN","LOGIN_SUCCESS","LOGIN_FAIL","LOGGED_USER","LOGGED_USER_SUCCESS","LOGGED_USER_FAIL","REFRESH_TOKEN","REFRESH_TOKEN_SUCCESS","REFRESH_TOKEN_FAIL","GET_USERS","GET_USERS_SUCCESS","GET_USERS_FAIL","CREATE_USER","CREATE_USER_SUCCESS","CREATE_USER_FAIL","MODIFY_USER","MODIFY_USER_SUCCESS","MODIFY_USER_FAIL","DELETE_USER","DELETE_USER_SUCCESS","DELETE_USER_FAIL","requestBegin","type","requestSuccess","user","message","token","payload","requestFail","logout","dispatch","remove","login","username","password","rememberMe","requestPOST","email","motDePasse","then","objResponse","data","success","save","path","maxAge","preferences","page","role","defaults","headers","common","catch","objError","checkSession","load","undefined","decodedToken","tokenExpiration","exp","currentTime","Math","floor","Date","getTime","remainingTime","resetToken","requestGET","response"],"mappings":"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,CAAiBhB,OAA/C,EAAwDe,WAAW,CAACC,IAAZ,CAAiBA,IAAjB,CAAsBf,KAA9E,CAAf,CAAR;AACAhC,QAAAA,GAAG,CAACA,GAAJ,CAAQuD,QAAR,CAAiBC,OAAjB,CAAyBC,MAAzB,CAAgC,eAAhC,IAAmD,YAAYX,WAAW,CAACC,IAAZ,CAAiBA,IAAjB,CAAsBf,KAArF;AACA,OAND,MAMO;AACNI,QAAAA,QAAQ,CAACF,WAAW,CAACpB,kBAAD,EAAqBgC,WAAW,CAACC,IAAZ,CAAiBhB,OAAtC,CAAZ,CAAR;AACA;AACD,KAZK,EAaL2B,KAbK,CAaC,UAAAC,QAAQ,EAAI;AAClBvB,MAAAA,QAAQ,CAACF,WAAW,CAACpB,kBAAD,EAAqB6C,QAAQ,CAACe,QAAT,CAAkB3B,IAAlB,CAAuBhB,OAA5C,CAAZ,CAAR;AACA,KAfK,CAAP;AAgBA,GAlBD;AAmBA,C,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import api from \"../../api\";\nimport Cookie from \"react-cookies\";\nimport decode from \"jwt-decode\";\nimport { navigate, endNavigation } from \"./navigate\";\n\nexport const LOGOUT = \"LOGOUT\";\nexport const LOGIN = \"LOGIN\";\nexport const LOGIN_SUCCESS = \"LOGIN_SUCCESS\";\nexport const LOGIN_FAIL = \"LOGIN_FAIL\";\nexport const LOGGED_USER = \"LOGGED_USER\";\nexport const LOGGED_USER_SUCCESS = \"LOGGED_USER_SUCCESS\";\nexport const LOGGED_USER_FAIL = \"LOGGED_USER_FAIL\";\nexport const REFRESH_TOKEN = \"REFRESH_TOKEN\";\nexport const REFRESH_TOKEN_SUCCESS = \"REFRESH_TOKEN_SUCCESS\";\nexport const REFRESH_TOKEN_FAIL = \"REFRESH_TOKEN_FAIL\";\n\nexport const GET_USERS = \"GET_USERS\";\nexport const GET_USERS_SUCCESS = \"GET_USERS_SUCCESS\";\nexport const GET_USERS_FAIL = \"GET_USERS_FAIL\";\nexport const CREATE_USER = \"CREATE_USER\";\nexport const CREATE_USER_SUCCESS = \"CREATE_USER_SUCCESS\";\nexport const CREATE_USER_FAIL = \"CREATE_USER_FAIL\";\nexport const MODIFY_USER = \"MODIFY_USER\";\nexport const MODIFY_USER_SUCCESS = \"MODIFY_USER_SUCCESS\";\nexport const MODIFY_USER_FAIL = \"MODIFY_USER_FAIL\";\nexport const DELETE_USER = \"DELETE_USER\";\nexport const DELETE_USER_SUCCESS = \"DELETE_USER_SUCCESS\";\nexport const DELETE_USER_FAIL = \"DELETE_USER_FAIL\";\n\nfunction requestBegin(type) {\n\treturn { type };\n}\n\nfunction requestSuccess(type, user, message, token) {\n\treturn { type, payload: { user, message, token } };\n}\n\nfunction requestFail(type, message) {\n\treturn { type, payload: { message } };\n}\n\nexport function logout() {\n\treturn dispatch => {\n\t\tCookie.remove(\"sessionCookie\");\n\t\treturn dispatch(requestBegin(LOGOUT));\n\t};\n}\n\nexport function login(username, password, rememberMe) {\n\treturn dispatch => {\n\t\tdispatch(requestBegin(LOGIN));\n\t\treturn api\n\t\t\t.requestPOST(\"/authenticate\", {\n\t\t\t\temail: username,\n\t\t\t\tmotDePasse: password\n\t\t\t})\n\t\t\t.then(objResponse => {\n\t\t\t\tif (objResponse.data.success) {\n\t\t\t\t\tconst { user, token } = objResponse.data.data;\n\t\t\t\t\tconst data = { user, token };\n\t\t\t\t\tCookie.save(\"sessionCookie\", data, { path: \"/\", maxAge: 3600 });\n\t\t\t\t\tif (rememberMe === true) {\n\t\t\t\t\t\tconst preferences = { email: username, rememberMe };\n\t\t\t\t\t\tCookie.save(\"userPreferences\", preferences, { path: \"/\" });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tCookie.remove(\"userPreferences\");\n\t\t\t\t\t}\n\t\t\t\t\tdispatch(requestSuccess(LOGIN_SUCCESS, user, objResponse.data.message, token));\n\t\t\t\t\tlet page = \"\";\n\t\t\t\t\tswitch (user.role) {\n\t\t\t\t\t\tcase \"caissier\":\n\t\t\t\t\t\t\tpage = \"/validate_solicitude\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"directeur\":\n\t\t\t\t\t\t\tpage = \"/director_reports\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"vendeur\":\n\t\t\t\t\t\t\tpage = \"/orders\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"contable\":\n\t\t\t\t\t\t\tpage = \"/cash_status\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"assistance\":\n\t\t\t\t\t\t\tpage = \"/warehouse\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"comite\":\n\t\t\t\t\t\t\tpage = \"/benefits_reports\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tapi.api.defaults.headers.common[\"Authorization\"] = \"bearer \" + token;\n\t\t\t\t\tdispatch(navigate(page));\n\t\t\t\t\tdispatch(endNavigation());\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(requestFail(LOGIN_FAIL, objResponse.data.message));\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(objError => {\n\t\t\t\tdispatch(requestFail(LOGIN_FAIL, objError));\n\t\t\t});\n\t};\n}\n\nexport function checkSession() {\n\treturn dispatch => {\n\t\tdispatch(requestBegin(LOGGED_USER));\n\t\tlet data = Cookie.load(\"sessionCookie\");\n\t\tif (data !== undefined) {\n\t\t\tconst { user, token } = data;\n\t\t\tconst decodedToken = decode(token);\n\t\t\tconst tokenExpiration = decodedToken.exp;\n\t\t\tconst currentTime = Math.floor(new Date().getTime() / 1000.0);\n\t\t\tconst remainingTime = tokenExpiration - currentTime;\n\t\t\tCookie.save(\"sessionCookie\", data, {\n\t\t\t\tpath: \"/\",\n\t\t\t\tmaxAge: remainingTime\n\t\t\t});\n\t\t\tdispatch(requestSuccess(LOGGED_USER_SUCCESS, user, \"Session Open\", token));\n\t\t\tapi.api.defaults.headers.common[\"Authorization\"] = \"bearer \" + token;\n\t\t} else {\n\t\t\tdispatch(requestFail(LOGGED_USER_FAIL, \"No Session\"));\n\t\t}\n\t};\n}\n\nexport function resetToken() {\n\treturn dispatch => {\n\t\tdispatch(requestBegin(REFRESH_TOKEN));\n\t\treturn api\n\t\t\t.requestGET(\"/resetToken\")\n\t\t\t.then(objResponse => {\n\t\t\t\tif (objResponse.data.success) {\n\t\t\t\t\tlet data = Cookie.load(\"sessionCookie\");\n\t\t\t\t\tdata = { ...data, token: objResponse.data.data.token };\n\t\t\t\t\tCookie.save(\"sessionCookie\", data, { path: \"/\", maxAge: 3600 });\n\t\t\t\t\tdispatch(requestSuccess(REFRESH_TOKEN_SUCCESS, null, objResponse.data.message, objResponse.data.data.token));\n\t\t\t\t\tapi.api.defaults.headers.common[\"Authorization\"] = \"bearer \" + objResponse.data.data.token;\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(requestFail(REFRESH_TOKEN_FAIL, objResponse.data.message));\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(objError => {\n\t\t\t\tdispatch(requestFail(REFRESH_TOKEN_FAIL, objError.response.data.message));\n\t\t\t});\n\t};\n}\n\n// export function getUsers() {\n//   return dispatch => {\n//     dispatch(getUsersBegin());\n//     return api\n//       .requestGET(\"/usuarios\")\n//       .then(objResponse => {\n//         dispatch(getUsersSuccess(objResponse.data.results));\n//       })\n//       .catch(objError => {\n//         dispatch(getUsersFail(objError));\n//       });\n//   };\n// }\n\n// export function createUser(user, onClose) {\n//   return dispatch => {\n//     dispatch(createUserBegin());\n//     return api\n//       .requestPOST(\"/usuarios\", {\n//         nombres: user.nombres,\n//         appelidos: user.appelidos,\n//         cedula: user.cedula,\n//         telefono: user.telefono,\n//         direccion: user.direccion,\n//         usuario: user.usuario,\n//         correo: user.correo,\n//         password: user.password\n//       })\n//       .then(objResponse => {\n//         dispatch(createUserSuccess(objResponse.data));\n//         onClose();\n//       })\n//       .catch(objError => {\n//         dispatch(createUserFail(objError));\n//       });\n//   };\n// }\n\n// export function modifyUser(user, onClose) {\n//   return dispatch => {\n//     dispatch(modifyUserBegin());\n//     return api\n//       .requestPUT(`/usuarios/${user.id}`, {\n//         nombres: user.nombres,\n//         appelidos: user.appelidos,\n//         cedula: user.cedula,\n//         telefono: user.telefono,\n//         direccion: user.direccion,\n//         usuario: user.usuario,\n//         correo: user.correo,\n//         password: user.password\n//       })\n//       .then(objResponse => {\n//         console.log(objResponse);\n//         dispatch(modifyUserSuccess(user));\n//         onClose();\n//       })\n//       .catch(objError => {\n//         dispatch(modifyUserFail(objError));\n//       });\n//   };\n// }\n\n// export function deleteUser(id, onClose) {\n//   return dispatch => {\n//     dispatch(deleteUserBegin());\n//     return api\n//       .requestDELETE(`/usuarios/${id.id}`)\n//       .then(objResponse => {\n//         console.log(objResponse);\n//         dispatch(deleteUserSuccess(id.id));\n//         onClose();\n//       })\n//       .catch(objError => {\n//         dispatch(deleteUserFail(objError));\n//       });\n//   };\n// }\n"]},"metadata":{},"sourceType":"module"}